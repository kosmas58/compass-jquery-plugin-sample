!!! Strict
%html{:lang => "en", "xml:lang" => "en", :xmlns => "http://www.w3.org/1999/xhtml"}
  %head
    %meta{:content => "text/html; charset=utf-8", "http-equiv" => "Content-Type"}/
    %title jqGrid Demos
    %link{:href => "themes/redmond/jquery-ui-1.8.2.custom.css", :media => "screen", :rel => "stylesheet", :type => "text/css"}/
    %link{:href => "themes/ui.jqgrid.css", :media => "screen", :rel => "stylesheet", :type => "text/css"}/
    %link{:href => "themes/ui.multiselect.css", :media => "screen", :rel => "stylesheet", :type => "text/css"}/
    :css
      html, body {
      	margin: 0;			/* Remove body margin/padding */
      	padding: 0;
      	overflow: hidden;	/* Remove scroll bars on browser window */	
          font-size: 75%;
      }
      /*Splitter style */
      
      
      #LeftPane {
      	/* optional, initial splitbar position */
      	overflow: auto;
      }
      /*
       * Right-side element of the splitter.
      */
      
      #RightPane {
      	padding: 2px;
      	overflow: auto;
      }
      .ui-tabs-nav li {position: relative;}
      .ui-tabs-selected a span {padding-right: 10px;}
      .ui-tabs-close {display: none;position: absolute;top: 3px;right: 0px;z-index: 800;width: 16px;height: 14px;font-size: 10px; font-style: normal;cursor: pointer;}
      .ui-tabs-selected .ui-tabs-close {display: block;}
      .ui-layout-west .ui-jqgrid tr.jqgrow td { border-bottom: 0px none;}
      .ui-datepicker {z-index:1200;}
    %script{:src => "js/jquery.js", :type => "text/javascript"}
    %script{:src => "js/jquery-ui-1.8.2.custom.min.js", :type => "text/javascript"}
    %script{:src => "js/jquery.layout.js", :type => "text/javascript"}
    %script{:src => "js/i18n/grid.locale-en.js", :type => "text/javascript"}
    :javascript
      $.jgrid.no_legacy_api = true;
      $.jgrid.useJSON = true;
    %script{:src => "js/jquery.jqGrid.min.js", :type => "text/javascript"}
    %script{:src => "js/jquery.tablednd.js", :type => "text/javascript"}
    %script{:src => "js/jquery.contextmenu.js", :type => "text/javascript"}
    %script{:src => "js/ui.multiselect.js", :type => "text/javascript"}
    :javascript
      jQuery(document).ready(function(){
          //$('#switcher').themeswitcher();
      
      	$('body').layout({
      		resizerClass: 'ui-state-default',
              west__onresize: function (pane, $Pane) {
                  jQuery("#west-grid").jqGrid('setGridWidth',$Pane.innerWidth()-2);
      		}
      	});
      	$.jgrid.defaults = $.extend($.jgrid.defaults,{loadui:"enable"});
      	var maintab =jQuery('#tabs','#RightPane').tabs({
              add: function(e, ui) {
                  // append close thingy
                  $(ui.tab).parents('li:first')
                      .append('')
                      .find('span.ui-tabs-close')
                      .click(function() {
                          maintab.tabs('remove', $('li', maintab).index($(this).parents('li:first')[0]));
                      });
                  // select just added tab
                  maintab.tabs('select', '#' + ui.panel.id);
              }
          });
          jQuery("#west-grid").jqGrid({
              url: "tree.xml",
              datatype: "xml",
              height: "auto",
              pager: false,
              loadui: "disable",
              colNames: ["id","Items","url"],
              colModel: [
                  {name: "id",width:1,hidden:true, key:true},
                  {name: "menu", width:150, resizable: false, sortable:false},
                  {name: "url",width:1,hidden:true}
              ],
              treeGrid: true,
      		caption: "jqGrid Demos",
              ExpandColumn: "menu",
              autowidth: true,
              //width: 180,
              rowNum: 200,
              ExpandColClick: true,
              treeIcons: {leaf:'ui-icon-document-b'},
              onSelectRow: function(rowid) {
                  var treedata = $("#west-grid").jqGrid('getRowData',rowid);
                  if(treedata.isLeaf=="true") {
                      //treedata.url
                      var st = "#t"+treedata.id;
      				if($(st).html() != null ) {
      					maintab.tabs('select',st);
      				} else {
      					maintab.tabs('add',st, treedata.menu);
      					$(st,"#tabs").load(treedata.url);
      				}
                  }
              }
          });
      	
      // end splitter
      
      });
  %body
    <script type="text/javascript"
    \//src="http://ui.jquery.com/themeroller/themeswitchertool/">
    #LeftPane.ui-layout-west.ui-widget.ui-widget-content
      %table#west-grid
    / #LeftPane
    #RightPane.ui-layout-center.ui-helper-reset.ui-widget-content
      / Tabs pane
      #switcher
      #tabs.jqgtabs
        %ul
          %li
            %a{:href => "#tabs-1"} jqGrid 3.6
        #tabs-1{:style => "font-size:12px;"}
          Many Thanks to Mark Williams which do the most of the new things added in 3.6
          %br/
          %br/
          Enjoy
    / #RightPane
  / Piwik
  :javascript
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://www.trirand.com/piwik/" : "http://www.trirand.com/piwik/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
  :javascript
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
  / End Piwik Tag
