(function(d){function h(b,a){return b===void 0?a==="undefined":b===null?a==="null":b.constructor.toString().match(RegExp(a,"i"))!==null}function n(b,a){if(b&&b[a]){var d=b[a];delete b[a];return d}}function r(b){if(typeof b!=="string"||b.length<2)return!1;b=b.charAt(0);return!(b==="."||b==="#"||b==="%")?!1:!0}function o(b,a){var s;function f(b,a){a===void 0||a===null||(a.nodeType||a.jquery?b.append(a):h(a,"String")&&a.length>0?(a[0]==="\\"&&(a=a.substr(1)),b.append(document.createTextNode(a))):h(a,
"Number")?b.append(document.createTextNode(a)):h(a,"Array")&&a.length>0&&o(b,a))}var k,j,c,e,i,l,g;c=Array.prototype.slice.call(a,0);c.length&&c.length>0?(r(c[0])&&(e=c.shift(),i=e.match(/\.[^\.#]+/g),l=e.match(/#[^\.#]+/g),s=(e=e.match(/^%([^\.#]+)/g))?e[0].substr(1):"div",e=s,g=d(document.createElement(e)),c.length>0&&h(c[0],"Object")&&!c[0].nodeType&&!c[0].jquery&&(e=c.shift(),k=n(e,"css"),j=n(e,"$"),g.attr(e)),l&&d.each(l,function(){var a,b;a=this.substr(1);(b=g.attr("id"))?g.attr("id",b+" "+
a):g.attr("id",a)}),i&&d.each(i,function(){g.addClass(this.substr(1))}),k&&g.css(k),b.append(g),b=g,j&&d.each(j,function(a){m.push({node:b,method:a,params:this})})),d.each(c,function(){f(b,this)})):f(b,c)}function p(){d.each(m,function(){if(this.method==="$")this.params.apply(this.node,[]);else{if(!h(this.params,"Array"))this.params=[this.params];this.node[this.method].apply(this.node,this.params)}});m=[]}function q(b){var a;a=d(document.createElement("div"));o(a,b);this.append(a.contents());this.closest("body").length>
0&&p();return a.contents()}var m=[],i={};d.fn.insertHaml=function(){return q.call(this,Array.prototype.slice.call(arguments,0))};d.fn.haml=function(){q.call(this,Array.prototype.slice.call(arguments,0));return this};d.haml={placeholder:function(b){function a(){var a=d(document.createElement("div"));a.haml(b.apply(this,arguments));return f=a.contents()}var f;return{inject:a,update:function(){var b=arguments;d.each(f,function(f,c){f===0?d(c).replaceWith(a.apply(this,b)):d(c).remove()});p()}}},onDemand:function(b,
a){var f,a=["%div",{style:"text-align: center; cursor: wait"},a||"Loading..."];return function(h){var j=Array.prototype.slice.call(arguments,1);return f=d.haml.placeholder(function(){var c=Util.stringify(j);return i[c]!==void 0?h(i[c]):(b.apply(this,[function(a){i[c]=a;f.update()}].concat(j)),a)})}}}})(jQuery);
