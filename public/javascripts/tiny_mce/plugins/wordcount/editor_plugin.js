(function(){tinymce.create("tinymce.plugins.WordCount",{block:0,id:null,countre:null,cleanre:null,init:function(a){var b=this,e=0;b.countre=a.getParam("wordcount_countregex",/[\w\u2019\'-]+/g);b.cleanre=a.getParam("wordcount_cleanregex",/[0-9.(),;:!?%#$?\'\"_+=\\\/-]*/g);b.id=a.id+"-word-count";a.onPostRender.add(function(c){var d;if(d=c.getParam("wordcount_target_id"))tinymce.DOM.add(d,"span",{},'<span id="'+b.id+'">0</span>');else(d=tinymce.DOM.get(c.id+"_path_row"))&&tinymce.DOM.add(d.parentNode,
"div",{style:"float: right"},c.getLang("wordcount.words","Words: ")+'<span id="'+b.id+'">0</span>')});a.onInit.add(function(c){c.selection.onSetContent.add(function(){b._count(c)});b._count(c)});a.onSetContent.add(function(c){b._count(c)});a.onKeyUp.add(function(c,d){if(d.keyCode!=e){if(13==d.keyCode||8==e||46==e)b._count(c);e=d.keyCode}})},_getCount:function(a){var b=0;if(a=a.getContent({format:"raw"})){a=a.replace(/\.\.\./g," ");a=a.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ");a=a.replace(/(\w+)(&.+?;)+(\w+)/,
"$1$3").replace(/&.+?;/g," ");a=a.replace(this.cleanre,"");if(a=a.match(this.countre))b=a.length}return b},_count:function(a){var b=this;if(!b.block){b.block=1;setTimeout(function(){var e=b._getCount(a);tinymce.DOM.setHTML(b.id,e.toString());setTimeout(function(){b.block=0},2E3)},1)}},getInfo:function(){return{longname:"Word Count plugin",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/wordcount",version:tinymce.majorVersion+
"."+tinymce.minorVersion}}});tinymce.PluginManager.add("wordcount",tinymce.plugins.WordCount)})();
