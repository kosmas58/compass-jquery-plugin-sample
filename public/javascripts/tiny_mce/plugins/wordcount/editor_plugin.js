(function(){tinymce.create("tinymce.plugins.WordCount",{block:0,id:null,countre:null,cleanre:null,init:function(f,e){var h=this,g=0;h.countre=f.getParam("wordcount_countregex",/[\w\u2019\'-]+/g);h.cleanre=f.getParam("wordcount_cleanregex",/[0-9.(),;:!?%#$?\'\"_+=\\\/-]*/g);h.id=f.id+"-word-count";f.onPostRender.add(function(c,d){var b,a;a=c.getParam("wordcount_target_id");if(!a){b=tinymce.DOM.get(c.id+"_path_row");if(b){tinymce.DOM.add(b.parentNode,"div",{style:"float: right"},c.getLang("wordcount.words","Words: ")+'<span id="'+h.id+'">0</span>')}}else{tinymce.DOM.add(a,"span",{},'<span id="'+h.id+'">0</span>')}});f.onInit.add(function(a){a.selection.onSetContent.add(function(){h._count(a)});h._count(a)});f.onSetContent.add(function(a){h._count(a)});f.onKeyUp.add(function(b,a){if(a.keyCode==g){return}if(13==a.keyCode||8==g||46==g){h._count(b)}g=a.keyCode})},_getCount:function(h){var f=0;var e=h.getContent({format:"raw"});if(e){e=e.replace(/\.\.\./g," ");e=e.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ");e=e.replace(/(\w+)(&.+?;)+(\w+)/,"$1$3").replace(/&.+?;/g," ");e=e.replace(this.cleanre,"");var g=e.match(this.countre);if(g){f=g.length}}return f},_count:function(d){var c=this;if(c.block){return}c.block=1;setTimeout(function(){if(!d.destroyed){var a=c._getCount(d);tinymce.DOM.setHTML(c.id,a.toString());setTimeout(function(){c.block=0},2000)}},1)},getInfo:function(){return{longname:"Word Count plugin",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/wordcount",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("wordcount",tinymce.plugins.WordCount)})();