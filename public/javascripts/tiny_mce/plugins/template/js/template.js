tinyMCEPopup.requireLangPack();
var TemplateDialog={preInit:function(){var b=tinyMCEPopup.getParam("template_external_list_url");b!=null&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(b)+'"><\/script>')},init:function(){var b,c,a;b=tinyMCEPopup.editor.getParam("template_templates",false);c=document.getElementById("tpath");if(!b&&typeof tinyMCETemplateList!="undefined"){a=0;for(b=[];a<tinyMCETemplateList.length;a++)b.push({title:tinyMCETemplateList[a][0],src:tinyMCETemplateList[a][1],
description:tinyMCETemplateList[a][2]})}for(a=0;a<b.length;a++)c.options[c.options.length]=new Option(b[a].title,tinyMCEPopup.editor.documentBaseURI.toAbsolute(b[a].src));this.resize();this.tsrc=b},resize:function(){var b,c,a;if(self.innerWidth){b=self.innerWidth-50;c=self.innerHeight-170}else{b=document.body.clientWidth-50;c=document.body.clientHeight-160}if(a=document.getElementById("templatesrc")){a.style.height=Math.abs(c)+"px";a.style.width=Math.abs(b-5)+"px"}},loadCSSFiles:function(b){var c=
tinyMCEPopup.editor;tinymce.each(c.getParam("content_css","").split(","),function(a){b.write('<link href="'+c.documentBaseURI.toAbsolute(a)+'" rel="stylesheet" type="text/css" />')})},selectTemplate:function(b,c){var a,d=this.tsrc;if(b){window.frames.templatesrc.document.body.innerHTML=this.templateHTML=this.getFileContents(b);for(a=0;a<d.length;a++)if(d[a].title==c)document.getElementById("tmpldesc").innerHTML=d[a].description||""}},insert:function(){tinyMCEPopup.execCommand("mceInsertTemplate",
false,{content:this.templateHTML,selection:tinyMCEPopup.editor.selection.getContent()});tinyMCEPopup.close()},getFileContents:function(b){function c(d){a=0;try{a=new ActiveXObject(d)}catch(e){}return a}var a;a=window.ActiveXObject?c("Msxml2.XMLHTTP")||c("Microsoft.XMLHTTP"):new XMLHttpRequest;a.overrideMimeType&&a.overrideMimeType("text/plain");a.open("GET",b,false);a.send(null);return a.responseText}};TemplateDialog.preInit();tinyMCEPopup.onInit.add(TemplateDialog.init,TemplateDialog);
