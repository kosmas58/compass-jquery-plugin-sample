(function(){var g=tinymce.dom.Event,h=tinymce.DOM;tinymce.create("tinymce.plugins.ContextMenu",{init:function(b){function a(e,c){f=null;if(c&&c.button==2)f=e.selection.getRng();else if(d._menu){d._menu.removeAll();d._menu.destroy();g.remove(e.getDoc(),"click",a)}}var d=this,f,i;d.editor=b;d.onContextMenu=new tinymce.util.Dispatcher(this);i=b.onContextMenu.add(function(e,c){if(!c.ctrlKey){f&&e.selection.setRng(f);d._getMenu(e).showMenu(c.clientX||c.pageX,c.clientY||c.pageX);g.add(e.getDoc(),"click",
function(j){a(e,j)});g.cancel(c)}});b.onRemove.add(function(){d._menu&&d._menu.removeAll()});b.onMouseDown.add(a);b.onKeyDown.add(a);b.onKeyDown.add(function(e,c){if(c.shiftKey&&!c.ctrlKey&&!c.altKey&&c.keyCode===121){g.cancel(c);i(e,c)}})},getInfo:function(){return{longname:"Contextmenu",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/contextmenu",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_getMenu:function(b){var a=
this._menu,d=b.selection,f=d.isCollapsed();d=d.getNode()||b.getBody();if(a){a.removeAll();a.destroy()}a=h.getPos(b.getContentAreaContainer());h.getPos(b.getContainer());this._menu=a=b.controlManager.createDropMenu("contextmenu",{offset_x:a.x+b.getParam("contextmenu_offset_x",0),offset_y:a.y+b.getParam("contextmenu_offset_y",0),constrain:1,keyboard_focus:true});a.add({title:"advanced.cut_desc",icon:"cut",cmd:"Cut"}).setDisabled(f);a.add({title:"advanced.copy_desc",icon:"copy",cmd:"Copy"}).setDisabled(f);
a.add({title:"advanced.paste_desc",icon:"paste",cmd:"Paste"});if(d.nodeName=="A"&&!b.dom.getAttrib(d,"name")||!f){a.addSeparator();a.add({title:"advanced.link_desc",icon:"link",cmd:b.plugins.advlink?"mceAdvLink":"mceLink",ui:true});a.add({title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"})}a.addSeparator();a.add({title:"advanced.image_desc",icon:"image",cmd:b.plugins.advimage?"mceAdvImage":"mceImage",ui:true});a.addSeparator();b=a.addMenu({title:"contextmenu.align"});b.add({title:"contextmenu.left",
icon:"justifyleft",cmd:"JustifyLeft"});b.add({title:"contextmenu.center",icon:"justifycenter",cmd:"JustifyCenter"});b.add({title:"contextmenu.right",icon:"justifyright",cmd:"JustifyRight"});b.add({title:"contextmenu.full",icon:"justifyfull",cmd:"JustifyFull"});this.onContextMenu.dispatch(this,a,d,f);return a}});tinymce.PluginManager.add("contextmenu",tinymce.plugins.ContextMenu)})();
